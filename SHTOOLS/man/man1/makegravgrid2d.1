.\" Automatically generated by Pod::Man 2.16 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "MAKEGRAVGRID2D 1"
.TH MAKEGRAVGRID2D 1 "2012-03-18" "SHTOOLS 2.7" "SHTOOLS 2.7"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "MakeGravGrid2D"
.IX Header "MakeGravGrid2D"
.IP "MakeGravGrid2D \-" 18
.IX Item "MakeGravGrid2D -"
Create a 2D cylindrical map of the gravity or gravitational potential referenced to a flattened ellipsoid from a set of spherical harmonic coefficients.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.IP "\s-1SUBROUTINE\s0 MakeGravGrid2D (" 28
.IX Item "SUBROUTINE MakeGravGrid2D ("
\&\s-1RAD\s0, \s-1CILM\s0, \s-1LMAX\s0, R0, A, F, \s-1GM\s0, \s-1GRAVPOT\s0, \s-1INTERVAL\s0, \s-1NLAT\s0, \s-1NLONG\s0, \s-1THETA\s0, \s-1PHI\s0, \s-1TOTAL\s0, \s-1OMEGA\s0, \s-1NORTH\s0, \s-1SOUTH\s0, \s-1EAST\s0, \s-1WEST\s0, \s-1NORMAL_GRAVITY\s0 )
.RS 4
.IP "REAL*8" 19
.IX Item "REAL*8"
\&\s-1RAD\s0(180/INTERVAL+1, 360/INTERVAL+1), \s-1CILM\s0(2,\ \s-1LMAX+1\s0,\ \s-1LMAX+1\s0), R0, A, F, \s-1GM\s0, \s-1INTERVAL\s0
.IP "\s-1INTEGER\s0" 19
.IX Item "INTEGER"
\&\s-1LMAX\s0, \s-1NLAT\s0, \s-1NLONG\s0, \s-1NORMAL_GRAVITY\s0
.IP "CHARACTER*1" 19
.IX Item "CHARACTER*1"
\&\s-1GRAVPOT\s0
.IP "REAL*8, \s-1OPTIONAL\s0" 19
.IX Item "REAL*8, OPTIONAL"
\&\s-1THETA\s0(180/INTERVAL+1, 360/INTERVAL+1), \s-1PHI\s0(180/INTERVAL+1, 360/INTERVAL+1), \s-1TOTAL\s0(180/INTERVAL+1, 360/INTERVAL+1), \s-1OMEGA\s0, \s-1NORTH\s0, \s-1SOUTH\s0, \s-1EAST\s0, \s-1WEST\s0
.RE
.RS 4
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fIMakeGravGrid2D\fR will create a 2\-dimensional cylindrical map, equally spaced in (geocentric) latitude and longitude, of either the gravitational potential, radial gravity, or all three components of the gravitational vector (in geocentric coordinates). The gravitational potential is given by
.PP
V = GM/r Sum_{l=0}^LMAX (R0/r)^l Sum_{m=\-l}^l C_{lm} Y_{lm}.
.PP
The coefficients are referenced to a radius R0, and the function is computed on a flattened ellipsoid with semi-major axis A (i.e., the mean equatorial radius) and flattening F. If the entire radial gravitational acceleration is to be calculated, it is necessary that the degree\-0 term be set equal to 1. When the radial gravity is output, the values are in \s-1SI\s0 units (m/s^2, to convert to mGals multiply by 10^5), and the sign is positive when directed upwards. If the optional angular rotation rate \s-1OMEGA\s0 is specified, the potential and radial gravitational acceleration will be calculated in a body-fixed rotating reference frame.
.PP
The other two components and magnitude of the gravitational field can be calculated by specifying the optional arrays \s-1THETA\s0, \s-1PHI\s0, and \s-1TOTAL\s0. In this case, all three optional parameters must be specified. To remove the \*(L"normal gravity\*(R" (total gravitational acceleration on the ellipsoid) from the magnitude of the total gravity field (to obtain the \*(L"gravity disturbance\*(R"), set \s-1NORMAL_GRAVITY\s0 equal to 1.
.PP
The calculated values should be considered exact only when the radii on the ellipsoid are less than the maximum radius of the planet (the potential coefficients are simply downward continued in the spectral domain). Furthermore, the components of gravity vector are calculated along a vector whose origin is at the center of the planet; the components are not normal to the reference ellipsoid.
.PP
The output grid is in raster format possessing upper-left and lower-right coordinates of (90 N, 0 E) and (90 S, 360 E), respectively. If the optional parameters \s-1NORTH\s0, \s-1SOUTH\s0, \s-1EAST\s0 and \s-1WEST\s0 are specified, then the output grid will possess upper-left and lower-right coordinates of (\s-1NORTH\s0, \s-1WEST\s0) and (\s-1SOUTH\s0, \s-1EAST\s0), respectively. The employed spherical harmonic normalization and Condon-Shortley phase convention use the default geodesy 4\-pi normalized harmonics that exclude the Condon-Shortley phase of (\-1)^m.
.SH "ARGUMENTS"
.IX Header "ARGUMENTS"
.IP "\s-1RAD\s0" 11
.IX Item "RAD"
(output) REAL*8, \s-1DIMENSION\s0(180/INTERVAL+1, 360/INTERVAL+1)
.Sp
A 2D equally spaced map of the radial gravity or gravitational potential corresponding to the input spherical harmonic coefficients \s-1CILM\s0. The  array is in raster format with upper-left and lower-right coordinates of (90 N, 0 E) and (90 S, 360 E), respectively. The output is in \s-1SI\s0 units (i.e., m^2/s^2 for the potential, and m/s^2 for the gravity).
.IP "\s-1CILM\s0" 11
.IX Item "CILM"
(input) REAL*8, \s-1DIMENSION\s0 (2, \s-1LMAX+1\s0, \s-1LMAX+1\s0)
.Sp
The real gravitational potential spherical harmonic coefficients to be expanded in the space domain. The coefficients C1lm and C2lm refer to the \*(L"cosine\*(R" (Clm) and \*(L"sine\*(R" (Slm) coefficients, respectively, with Clm = \s-1CILM\s0(1, l+1, m+1) and Slm = \s-1CILM\s0(2, l+1, m+1). Alternatively, C1lm and C2lm correspond to the positive and negative order coefficients, respectively.
.IP "\s-1LMAX\s0" 11
.IX Item "LMAX"
(input) \s-1INTEGER\s0
.Sp
The maximum spherical harmonic degree of the coefficients \s-1CILM\s0.
.IP "R0" 11
.IX Item "R0"
(input) REAL*8
.Sp
The reference radius of the spherical harmonic coefficients.
.IP "A" 11
.IX Item "A"
(input) REAL*8
.Sp
The semi-major axis of the flattened ellipsoid for which the field will be computed on.
.IP "F" 11
.IX Item "F"
(input) REAL*8
.Sp
The flattening of the reference ellipsoid: i.e., F = (R_equator \- R_pole) / R_equator = (A \- B) / A.
.IP "\s-1GM\s0" 11
.IX Item "GM"
(input) REAL*8
.Sp
The gravitational constant multiplied by the planetary mass.
.IP "\s-1GRAVPOT\s0" 11
.IX Item "GRAVPOT"
(input) CHARACTER*1
.Sp
\&\*(L"U\*(R" to compute the gravitational potential or \*(L"G\*(R" to compute the gravity.
.IP "\s-1INTERVAL\s0" 11
.IX Item "INTERVAL"
(input) REAL*8
.Sp
The latitudinal and longitudinal spacing of \s-1GRID\s0 in degrees.
.IP "\s-1NLAT\s0" 11
.IX Item "NLAT"
(output) \s-1INTEGER\s0
.Sp
The number of latitudinal samples. Both 90 N and 90 S are included.
.IP "\s-1NLONG\s0" 11
.IX Item "NLONG"
(output) \s-1INTEGER\s0
.Sp
The number of longitudinal samples. Both 0 and 360 E are included.
.IP "\s-1THETA\s0" 11
.IX Item "THETA"
(output) REAL*8, \s-1DIMENSION\s0(180/INTERVAL+1, 360/INTERVAL+1)
.Sp
A 2D equally spaced map of the theta component of the  gravity field corresponding to the input spherical harmonic coefficients \s-1CILM\s0. The  array is in raster format with upper-left and lower-right coordinates of (90 N, 0 E) and (90 S, 360 E), respectively. The output is in \s-1SI\s0 units (i.e., m/s^2).
.IP "\s-1PHI\s0" 11
.IX Item "PHI"
(output) REAL*8, \s-1DIMENSION\s0(180/INTERVAL+1, 360/INTERVAL+1)
.Sp
A 2D equally spaced map of the phi component of the  gravity field corresponding to the input spherical harmonic coefficients \s-1CILM\s0. The  array is in raster format with upper-left and lower-right coordinates of (90 N, 0 E) and (90 S, 360 E), respectively. The output is in \s-1SI\s0 units (i.e., m/s^2).
.IP "\s-1TOTAL\s0" 11
.IX Item "TOTAL"
(output) REAL*8, \s-1DIMENSION\s0(180/INTERVAL+1, 360/INTERVAL+1)
.Sp
A 2D equally spaced map of the magnitude of the gravity field corresponding to the input spherical harmonic coefficients \s-1CILM\s0. The  array is in raster format with upper-left and lower-right coordinates of (90 N, 0 E) and (90 S, 360 E), respectively. The output is in \s-1SI\s0 units (i.e., m/s^2).
.IP "\s-1OMEGA\s0" 11
.IX Item "OMEGA"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The angular rotation rate of the planet.
.IP "\s-1NORTH\s0" 11
.IX Item "NORTH"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The maximum latitude of the output raster grid, in degrees. The default is 90 degrees N.
.IP "\s-1SOUTH\s0" 11
.IX Item "SOUTH"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The minimum latitude of the output raster grid, in degrees. The default is \-90 degrees.
.IP "\s-1EAST\s0" 11
.IX Item "EAST"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The maximum longitude of the output raster grid, in degrees. The default is 360 degrees.
.IP "\s-1WEST\s0" 11
.IX Item "WEST"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The minimum longitude of the output raster grid, in degrees. The default is 0 degrees.
.IP "\s-1NORMAL_GRAVITY\s0" 11
.IX Item "NORMAL_GRAVITY"
(input) \s-1INTEGER\s0, \s-1OPTIONAL\s0
.Sp
If 1, the normal gravity (gravitational acceleration on the ellipsoid) will be subtracted from the total gravity, yielding the \*(L"gravity disturbance.\*(R" This is done using Somigliana's formula (after converting geocentric to geodetic coordinates).
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fImakegrid2d\fR\|(1), \fIshexpanddh\fR\|(1), \fImakegriddh\fR\|(1), \fIshexpandglq\fR\|(1), \fImakegridglq\fR\|(1), \fImakegeoidgrid\fR\|(1)
.PP
<http://shtools.ipgp.fr/>
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright 2012 by Mark Wieczorek <wieczor@ipgp.fr>.
.PP
This is free software; you can distribute and modify it under the terms of the revised \s-1BSD\s0 license.
