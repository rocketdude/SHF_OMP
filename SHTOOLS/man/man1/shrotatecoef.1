.\" Automatically generated by Pod::Man 2.16 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SHROTATECOEF 1"
.TH SHROTATECOEF 1 "2012-04-25" "SHTOOLS 2.8" "SHTOOLS 2.8"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "SHRotateCoef"
.IX Header "SHRotateCoef"
.IP "SHRotateCoef \-" 15
.IX Item "SHRotateCoef -"
Determine the spherical harmonic coefficients of a complex function rotated by three Euler angles.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.IP "\s-1SUBROUTINE\s0 SHRotateCoef (" 26
.IX Item "SUBROUTINE SHRotateCoef ("
X, \s-1COEF\s0, \s-1RCOEF\s0, \s-1DJ\s0, \s-1LMAX\s0 )
.RS 4
.IP "REAL*8" 10
.IX Item "REAL*8"
X(3), \s-1COEF\s0(2, (\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2), \s-1RCOEF\s0(2,\ (\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2), \s-1DJ\s0(\s-1LMAX+1\s0,\ \s-1LMAX+1\s0,\ \s-1LMAX+1\s0)
.IP "\s-1INTEGER\s0" 10
.IX Item "INTEGER"
\&\s-1LMAX\s0
.RE
.RS 4
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fISHRotateCoef\fR will take the complex spherical harmonic coefficients of a function, rotate it according to the three Euler anlges in X, and output the spherical harmonic coefficients of the rotated function. The input and output coefficients are in an indexed form that can be converted to and from \s-1CILM\s0(2,:,:) form by using the functions \fISHCilmToCindex\fR and \fISHCindexToCilm\fR. The coefficients \s-1MUST\s0 correspond to unit-normalized spherical harmonics that possess the Condon-Shortley phase convention. Real spherical harmonics can be converted to and from complex form using \fISHrtoc\fR and \fISHctor\fR. The input rotation matrix \s-1DJ\s0 is computed by a call to \fIDJPi2\fR.
.PP
The rotation of a coordinate system or body can be viewed in two complementary ways involving three successive rotations. Both methods have the same initial and final configurations, and the angles listed in both schemes are the same.
.IP "Scheme A:" 12
.IX Item "Scheme A:"
(I) Rotation about the z axis by alpha.
.Sp
(\s-1II\s0) Rotation about the new y axis by beta.
.Sp
(\s-1III\s0) Rotation about the new z axis by gamma.
.IP "Scheme B:" 12
.IX Item "Scheme B:"
(I) Rotation about the z axis by gamma.
.Sp
(\s-1II\s0) Rotation about the initial y axis by beta.
.Sp
(\s-1III\s0) Rotation about the initial z axis by alpha.
.PP
The rotations can further be viewed either as a rotation of the coordinate system or the physical body. For a rotation of the coordinate system without rotation of the physical body, use
.Sp
.RS 12
X(alpha, beta, gamma).
.RE
.PP
For a rotation of the physical body without rotation of the coordinate system, use
.Sp
.RS 12
X(\-gamma, \-beta, \-alpha).
.RE
.PP
To perform the inverse transform of X(alpha, beta, gamma), use X(\-gamma, \-beta, \-alpha).
.PP
Note that this routine uses the \*(L"y convention\*(R", where the second rotation is with respect to the new y axis. If alpha, beta, and gamma were orginally defined in terms of the \*(L"x convention\*(R", where the second rotation was with respect to the newx axis, the Euler angles according to the y convention would be alpha_y = alpha_x \- pi/2, beta_x = beta_y, and gamma_y = gamma_x + pi/2.
.SH "ARGUMENTS"
.IX Header "ARGUMENTS"
.IP "X" 13
.IX Item "X"
(input) REAL*8, \s-1DIMENSION\s0(3 )
.Sp
The three Euler angles, alpha, beta, and gamma.
.IP "\s-1COEF\s0" 13
.IX Item "COEF"
(input) REAL*8, \s-1DIMENSION\s0 (2, (\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2)
.Sp
The input complex spherical harmonic coefficients. This is an indexed array where the real and complex components are given by \s-1COEF\s0(1,:) and \s-1COEF\s0(2,:), respectively. The functions \fISHCilmToCindex\fR and \fISHCindexToCilm\fR are used to convert to and from indexed and \s-1CILM\s0(2,:,:) form. The coefficients must correspond to unit-normalized spherical harmonics that possess the Condon-Shortley phase convention.
.IP "\s-1RCOEF\s0" 13
.IX Item "RCOEF"
(output) REAL*8, \s-1DIMENSION\s0 (2, (\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2)
.Sp
The spherical harmonic coefficients of the rotated function in indexed form.
.IP "\s-1DJ\s0" 13
.IX Item "DJ"
(input) REAL*8, \s-1DIMENSION\s0 (\s-1LMAX+1\s0, \s-1LMAX+1\s0, \s-1LMAX+1\s0)
.Sp
The rotation matrix \s-1DJ\s0(pi/2), obtained from a call to \fIDJPi2\fR.
.IP "\s-1LMAX\s0" 13
.IX Item "LMAX"
(input) \s-1INTEGER\s0, \s-1OPTIONAL\s0
.Sp
The maximum spherical harmonic degree of the input and output coefficients.
.SH "NOTES"
.IX Header "NOTES"
This routine is based upon code originally written by Guy Masters, which was then subsequently modified by Mark Simons and myself.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIdjpi2\fR\|(1), \fIshrotaterealcoef\fR\|(1), \fIshctor\fR\|(1), \fIshrtoc\fR\|(1), \fIshcilmtocindex\fR\|(1), \fIshcindextocilm\fR\|(1)
.PP
<http://shtools.ipgp.fr/>
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright 2012 by Mark Wieczorek <wieczor@ipgp.fr>.
.PP
This is free software; you can distribute and modify it under the terms of the revised \s-1BSD\s0 license.
