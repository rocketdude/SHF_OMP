<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
	<title>SHTOOLS - Spherical harmonic transformations</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="stylesheet" type="text/css" href="../CSS/sh.css">
	<link rel="icon" type="image/vnd.microsoft.icon" href="../Figures/favicon.ico">
</head>

<body>

<div class="main">

	<p class="centeredimage"><img src="../Figures/logo.jpg" width=694 height=115 alt="SHTOOLS --- Tools for working with spherical harmonics"></p>
    	
	<table class="menu">
		<tbody>
			<tr>
				<td><a  href="http://shtools.ipgp.fr/">HOME</a></td>
				<td><a href="../download.html">DOWNLOAD</a></td>
				<td class="selected"><a href="../documentation.html">DOCUMENTATION</a></td>
				<td><a href="http://groups.google.com/group/SHTOOLS">FORUM</a></td>
				<td><a href="../faq.html">FAQ</a> </td>
			</tr>
		</tbody>
	</table>

	<p class="dir">
>  <a href="../../SHTOOLS.html" class="dir">Home</a> > <a href="../documentation.html" class="dir">Documentation</a> > <a href="../transformations.html" class="dir">Spherical Harmonic Transformations</a></p>
<PRE>
<!-- Manpage converted by man2html 3.0.1 -->
<B>SHEXPANDLSQ(1)</B>                    SHTOOLS 2.7                   <B>SHEXPANDLSQ(1)</B>


</PRE>
<H2 class="man">SHExpandLSQ</H2 class="man"><PRE>
       SHExpandLSQ - Expand a set of irregularly sampled data points into
                     spherical harmonics using a least squares inversion.


</PRE>
<H2 class="man">SYNOPSIS</H2 class="man"><PRE>
       SUBROUTINE SHExpandLSQ ( CILM, D, LAT, LON, NMAX, LMAX, NORM, CHI2,
                                CSPHASE )

           REAL*8             CILM(2, LMAX+1, LMAX+1), D(NMAX), LAT(NMAX),
                              LON(NMAX)

           INTEGER            NMAX, LMAX

           INTEGER, OPTIONAL  NORM, CHI2, CSPHASE


</PRE>
<H2 class="man">DESCRIPTION</H2 class="man"><PRE>
       <B>SHExpandLSQ</B> will expand a set of irregularly sampled data points into
       spherical harmonics by a least squares inversion. When there are more
       data points than spherical harmonic coefficients (i.e., NMAX &gt;
       (LMAX+1)**2), the solution of the overdetermined system will be
       determined. If there are more coefficients than data points, then the
       solution of the underdetermined system that minimizes the solution norm
       will be determined. See the LAPACK documentation concerning DGELS for
       further information.

       The employed spherical harmonic normalization and Condon-Shortley phase
       convention can be set by the optional arguments NORM and CSPHASE; if
       not set, the default is to use geodesy 4-pi normalized harmonics that
       exclude the Condon-Shortley phase of (-1)^m.


</PRE>
<H2 class="man">ARGUMENTS</H2 class="man"><PRE>
       CILM       (output) REAL*8, DIMENSION (2, LMAX+1, LMAX+1)

                  The real spherical harmonic coefficients of the function.
                  The coefficients C1lm and C2lm refer to the "cosine" (Clm)
                  and "sine" (Slm) coefficients, respectively, with Clm =
                  CILM(1, l+1, m+1) and Slm = CILM(2, l+1, m+1).
                  Alternatively, C1lm and C2lm correspond to the positive and
                  negative order coefficients, respectively.

       D          (input) REAL*8, DIMENSION (NMAX)

                  The value of the function at the coordinates (LAT, LON).

       LAT        (input) REAL*8, DIMENSION (NMAX)

                  The latitude in DEGREES corresponding to the value in D.

       LON        (input) REAL*8, DIMENSION (NMAX)

                  The longitude in DEGREES corresponding to the value in D.

       NMAX       (input) INTEGER

                  The number of data points.

       LMAX       (input) INTEGER

                  The maximum spherical harmonic degree of the output
                  coefficients CILM.

       NORM       (input) INTEGER, OPTIONAL

                  1 (default) = Geodesy 4-pi normalized harmonics; 2 = Schmidt
                  semi-normalized harmonics; 3 = unnormalized harmonics; 4 =
                  orthonormal harmonics.

       CHI2       (output) REAL*8, OPTIONAL

                  The residual sum of squares misfit for an overdetermined
                  inversion.

       CSPHASE    (input) INTEGER, OPTIONAL

                  1 (default) = do not apply the Condon-Shortley phase factor
                  to the associated Legendre functions; -1 = append the
                  Condon-Shortley phase factor of (-1)^m to the associated
                  Legendre functions.


</PRE>
<H2 class="man">SEE ALSO</H2 class="man"><PRE>
       <B>dgels(1)</B>

       &lt;http://shtools.ipgp.fr/&gt;


</PRE>
<H2 class="man">COPYRIGHT AND LICENSE</H2 class="man"><PRE>
       Copyright 2012 by Mark Wieczorek &lt;wieczor@ipgp.fr&gt;.

       This is free software; you can distribute and modify it under the terms
       of the revised BSD license.

SHTOOLS 2.7                       2012-03-08                    <B>SHEXPANDLSQ(1)</B>
</PRE>

	<p class="dir">
>  <a href="../../SHTOOLS.html" class="dir">Home</a> > <a href="../documentation.html" class="dir">Documentation</a> > <a href="../transformations.html" class="dir">Spherical Harmonic Transformations</a></p>

	<table class="footer2" summary = "Mark Wieczorek">
	<tbody>
		<tr>
			<td class="c1"><a href="http://www.ipgp.fr/">Institut de Physique du Globe de Paris</a></td>
			<td class="c2"><a href="http://www.sorbonne-paris-cite.fr/index.php/en">Sorbonne Paris Cité</a></td>
			<td class="c3">&copy; 2012 <a href="http://www.ipgp.fr/~wieczor">Mark Wieczorek</a></td>
		</tr>
	</tbody>
	</table>
	
</div>

</body>
</html>
